{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "$id": "https://rubyschema.pages.dev/rails/database.json",
  "title": "Rails Database Configuration",
  "description": "A list of environments and their respective database configurations.",
  "type": "object",
  "definitions": {
    "environment": {
      "description": "Guide: https://guides.rubyonrails.org/configuring.html#configuring-a-database",
      "type": "object",
      "properties": {
        "adapter": {
          "anyOf": [
            { "type": "string" },
            { "enum": ["postgresql", "mysql2", "sqlite3"] }
          ]
        },
        "url": {
          "type": "string"
        },
        "host": {
          "oneOf": [
            { "type": "string" },
            { "enum": ["localhost", "127.0.0.1"] }
          ]
        },
        "port": {
          "anyOf": [
            { "type": ["string", "integer"] },
            {
              "enum": ["3306", 3306, "5432", 5432]
            }
          ]
        },
        "migrations_paths": {
          "type": "string"
        },
        "retry_deadline": {
          "type": ["integer", "string"]
        },
        "query_cache": {
          "description": "Enable or disable query caching.",
          "type": ["string", "boolean"]
        },
        "database": {
          "type": "string"
        },
        "username": {
          "type": "string"
        },
        "password": {
          "type": "string"
        },
        "pool": {
          "description": "A connection pool synchronizes thread access to a limited number of database connections. This value sets the maximum number of connections that can be open to the database at the same time.\n\nIn most cases, this should be set to at least the number of threads your server manages.",
          "type": ["integer", "string"]
        },
        "timeout": {
          "description": "Specifies the timeout in milliseconds for database operations.",
          "type": ["integer", "string"]
        },
        "socket": {
          "type": "string"
        },
        "advisory_locks": {
          "type": ["boolean", "string"]
        },
        "statement_limit": {
          "type": ["integer", "string"]
        },
        "connection_retries": {
          "type": ["integer", "string"]
        },
        "encoding": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "enum": ["unicode", "utf8mb4"]
            }
          ]
        }
      },
      "additionalProperties": {
        "$ref": "#/definitions/environment"
      }
    }
  },
  "properties": {
    "default": {
      "$ref": "#/definitions/environment"
    },
    "production": {
      "$ref": "#/definitions/environment"
    },
    "development": {
      "$ref": "#/definitions/environment"
    },
    "test": {
      "$ref": "#/definitions/environment"
    }
  },
  "additionalProperties": {
    "$ref": "#/definitions/environment"
  }
}
